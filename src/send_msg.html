<!DOCTYPE html>
<html>
<head>
<title>ç¶²é è¨Šæ¯é€šçŸ¥</title>
<meta charset="UTF-8">
<style>
body {
    font-family: sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-top: 50px;
}
#notificationInput {
    padding: 10px;
    margin-bottom: 10px;
    width: 300px;
    border: 1px solid #ccc;
    border-radius: 4px;
}
#sendButton {
    padding: 10px 20px;
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}
#sendButton:hover {
    background-color: #45a049;
}
</style>
</head>
<body>

<h2>ç¶²é è¨Šæ¯é€šçŸ¥ ğŸ“¢</h2>
<input type="text" id="notificationInput" placeholder="è¼¸å…¥é€šçŸ¥è¨Šæ¯...">
<button id="sendButton">ç™¼é€é€šçŸ¥</button>

<script>
    document.addEventListener('DOMContentLoaded', () => {
    const notificationInput = document.getElementById('notificationInput');
    const sendButton = document.getElementById('sendButton');

    // æª¢æŸ¥ç€è¦½å™¨æ˜¯å¦æ”¯æ´ Notifications API
    if (!("Notification" in window)) {
        alert("ä½ çš„ç€è¦½å™¨ä¸æ”¯æ´æ¡Œé¢é€šçŸ¥åŠŸèƒ½ã€‚");
        sendButton.disabled = true;
        return;
    }

    // è«‹æ±‚é€šçŸ¥æ¬Šé™
    // åªæœ‰åœ¨ä½¿ç”¨è€…æ˜ç¢ºåŒæ„å¾Œï¼Œæ‰èƒ½ç™¼é€é€šçŸ¥
    function requestNotificationPermission() {
        Notification.requestPermission().then(permission => {
        if (permission === "granted") {
            console.log("é€šçŸ¥æ¬Šé™å·²ç²å–ï¼");
        } else {
            console.warn("é€šçŸ¥æ¬Šé™è¢«æ‹’çµ•ã€‚");
            alert("ä½ éœ€è¦å…è¨±é€šçŸ¥æ‰èƒ½æ”¶åˆ°è¨Šæ¯ã€‚");
        }
        });
    }

    // ç¶²é è¼‰å…¥æ™‚å…ˆè«‹æ±‚ä¸€æ¬¡æ¬Šé™ (æˆ–è€…ä½ å¯ä»¥åœ¨ä½¿ç”¨è€…é»æ“ŠæŒ‰éˆ•æ™‚æ‰è«‹æ±‚)
    requestNotificationPermission();

    // ç™¼é€é€šçŸ¥çš„å‡½æ•¸
    function sendNotification(message) {
        if (Notification.permission === "granted") {
        const notification = new Notification("æ–°è¨Šæ¯ï¼", {
            body: message,
            icon: 'https://via.placeholder.com/48' // ä½ å¯ä»¥æ›æˆè‡ªå·±çš„åœ–ç¤º URL
        });

        // å¯é¸ï¼šé»æ“Šé€šçŸ¥æ™‚çš„è¡Œç‚º
        notification.onclick = function () {
            window.focus(); // å°‡è¦–çª—å¸¶åˆ°å‰æ™¯
            this.close();    // é—œé–‰é€šçŸ¥
        };

        } else if (Notification.permission === "denied") {
        alert("é€šçŸ¥æ¬Šé™å…ˆå‰å·²è¢«æ‹’çµ•ï¼Œè«‹åˆ°ç€è¦½å™¨è¨­å®šä¸­ä¿®æ”¹ã€‚");
        } else {
        // å¦‚æœæ¬Šé™æ˜¯ "default" (ä½¿ç”¨è€…å°šæœªé¸æ“‡)ï¼Œå†æ¬¡è«‹æ±‚
        requestNotificationPermission();
        }
    }

    // æŒ‰éˆ•é»æ“Šäº‹ä»¶
    sendButton.addEventListener('click', () => {
        const message = notificationInput.value.trim();
        if (message) {
        sendNotification(message);
        notificationInput.value = ""; // æ¸…ç©ºè¼¸å…¥æ¡†
        } else {
        alert("è«‹è¼¸å…¥é€šçŸ¥è¨Šæ¯ï¼");
        }
    });
    });

    function requestNotificationPermission() {
  Notification.requestPermission().then(permission => {
    console.log("æ‰‹æ©Ÿä¸Šçš„æ¬Šé™è«‹æ±‚çµæœ:", permission); // åœ¨é ç«¯åµéŒ¯çš„ Console ä¸­æŸ¥çœ‹
    if (permission === "granted") {
      console.log("é€šçŸ¥æ¬Šé™å·²ç²å–ï¼");
    } else {
      console.warn("é€šçŸ¥æ¬Šé™è¢«æ‹’çµ•æˆ–é è¨­ã€‚");
      // å³ä½¿ä¹‹å‰è¨­ç‚ºå…è¨±ï¼Œå¦‚æœChromeé‡è¨­äº†ï¼Œé€™è£¡å¯èƒ½æœƒæ˜¯ denied æˆ– default
    }
  });
}
</script>

</body>
</html>